(function($,doc,win,editor){$(doc).ready(function(){try{if(doc.getElementById("wp-content-editor-container")!==undefined){var wpEditormd=editormd({id:"wp-content-editor-container",path:editor.editormdUrl+"/assets/Editormd/lib/",width:"100%",height:640,syncScrolling:editor.syncScrolling!=="off",watch:editor.watch!=="off",htmlDecode:editor.htmlDecode!=="off",toolbarAutoFixed:true,tocm:false,tocContainer:editor.toc==="off"?false:"",tocDropdown:false,theme:editor.theme,previewTheme:editor.previewTheme,editorTheme:editor.editorTheme,emoji:editor.emoji!=="off",tex:editor.tex!=="off",mind:editor.mindMap!=="off",mermaid:editor.mermaid!=="off",atLink:false,taskList:editor.taskList!=="off",imageUpload:editor.imagePasteSM!=="off",imageFormats:["jpg","jpeg","gif","png","bmp","webp"],imageUploadURL:"https://sm.ms/api/upload",placeholder:editor.placeholderEditor,prismTheme:editor.prismTheme,prismLineNumbers:editor.prismLineNumbers!=="off",toolbarIcons:function(){return["undo","redo","|","bold","del","italic","quote","ucwords","uppercase","lowercase","|","h1","h2","h3","h4","h5","h6","|","list-ul","list-ol","hr","|","link","reference-link","image","code","preformatted-text","code-block","table","datetime","html-entities","more","pagebreak",editor.emoji!=="off"?"emoji":"toc","|","goto-line","watch","preview","fullscreen","clear","search","|","help","info"]},onfullscreen:function(){$("#wp-content-editor-container").css({position:"fixed","z-index":"99999"})},onfullscreenExit:function(){$("#wp-content-editor-container").css({position:"relative","z-index":"auto"})},toolbarIconsClass:{toc:"fa-list-alt"},toolbarHandlers:{toc:function(cm,icon,cursor,selection){cm.replaceSelection("[toc]")}},lang:{toolbar:{toc:"The Table Of Contents"}},onload:function(){if(getWidth()<=782){setTimeout(function(){$(".editormd .CodeMirror.CodeMirror-wrap").css("margin-top","72px")},1000)}$(window).resize(function(){})}});var original_wp_media_editor_insert=wp.media.editor.insert;wp.media.editor.insert=function(html){var htmlDom=doc.createElement("div");htmlDom.style.display="none";htmlDom.id="htmlDom";htmlDom.innerHTML=html;doc.body.appendChild(htmlDom);var dom=doc.getElementById("htmlDom").childNodes[0];var markdownSrc;switch(dom.localName){case"a":if(dom.childNodes[0].localName==="img"){markdownSrc="[![]("+dom.childNodes[0].src+")]("+dom.href+")"}else{markdownSrc="["+dom.innerText+"]("+dom.href+")"}break;case"img":var htmlSrc=doc.getElementsByClassName("alignnone")[0].src;var htmlAlt=doc.getElementsByClassName("alignnone")[0].alt;markdownSrc="!["+htmlAlt+"]("+htmlSrc+")";break;default:markdownSrc=doc.getElementById("htmlDom").innerHTML}original_wp_media_editor_insert(markdownSrc);wpEditormd.insertValue(markdownSrc);doc.getElementById("htmlDom").remove()};if(editor.imagePaste==="on"){$("#wp-content-editor-container").on("paste",function(event){event=event.originalEvent;var cbd=window.clipboardData||event.clipboardData;var ua=window.navigator.userAgent;if(!(event.clipboardData&&event.clipboardData.items)){return}if(cbd.items&&cbd.items.length===2&&cbd.items[0].kind==="string"&&cbd.items[1].kind==="file"&&cbd.types&&cbd.types.length===2&&cbd.types[0]==="text/plain"&&cbd.types[1]==="Files"&&ua.match(/Macintosh/i)&&Number(ua.match(/Chrome\/(\d{2})/i)[1])<49){return}var itemLength=cbd.items.length;if(itemLength===0){return}if(itemLength===1&&cbd.items[0].kind==="string"){return}if((itemLength===1&&cbd.items[0].kind==="file")){var item=cbd.items[0];var blob=item.getAsFile();if(blob.size===0){return}function readBlobAsDataURL(blob,callback){var reader=new FileReader();reader.onload=function(e){callback(e.target.result)};reader.readAsDataURL(blob)}function dataURItoBlob(base64Data){var byteString;if(base64Data.split(",")[0].indexOf("base64")>=0){byteString=atob(base64Data.split(",")[1])}else{byteString=unescape(base64Data.split(",")[1])}var mimeString=base64Data.split(",")[0].split(":")[1].split(";")[0];var ia=new Uint8Array(byteString.length);for(var i=0;i<byteString.length;i++){ia[i]=byteString.charCodeAt(i)}return new Blob([ia],{type:mimeString})}readBlobAsDataURL(blob,function(dataurl){var uploadingText="!["+editor.imgUploading+"]";var uploadFailText="!["+editor.imgUploadeFailed+"]";var data={action:"imagepaste_action",dataurl:dataurl};wpEditormd.insertValue(uploadingText);if(editor.imagePasteSM==="on"){var formData=new FormData();var protocol=doc.location.protocol!=="http:";formData.append("smfile",dataURItoBlob(dataurl));formData.append("ssl",protocol);formData.append("format","json");$.ajax({url:"https://sm.ms/api/upload",type:"POST",processData:false,contentType:false,data:formData,success:function(request){if(request.code==="success"){wpEditormd.setValue(wpEditormd.getValue().replace(uploadingText,"!["+request.data.filename+"]("+request.data.url+")"))}else{wpEditormd.setValue(wpEditormd.getValue().replace(uploadingText,uploadFailText+"[ "+request.msg+" ]"))}}})}else{$.ajax({url:ajaxurl,type:"POST",data:data,success:function(request){var obj=eval("("+request+")");if(obj.error){wpEditormd.setValue(wpEditormd.getValue().replace(uploadingText,uploadFailText))}else{wpEditormd.setValue(wpEditormd.getValue().replace(uploadingText,"![]("+obj.url+")"))}}})}})}})}}}catch(e){console.error(e)}});editormd.prismURL={url:cdn_url(editor.staticFileCDN,"prism_config")};if(editor.tex==="on"){editormd.katexURL={css:cdn_url(editor.staticFileCDN,"katex_config")+"/katex.min",js:cdn_url(editor.staticFileCDN,"katex_config")+"/katex.min"}}if(editor.mermaid==="on"){editormd.mermaidURL={js:cdn_url(editor.staticFileCDN,"mermaid_config")+"/mermaid.min"}}if(editor.emoji==="on"){editormd.emoji={path:cdn_url(editor.staticFileCDN,"emojify")+"/",ext:".png"}}function cdn_url(url,lib){var lib_url;if(url==="//cdn.jsdelivr.net"){switch(lib){case"emojify":lib_url=url+"/npm/emojify.js@1.1.0/dist/images/basic";break;case"katex_config":lib_url=url+"/npm/katex@0.10.0-beta/dist";break;case"mermaid_config":lib_url=url+"/npm/mermaid@8.0.0-rc.8/dist";break;case"prism_config":lib_url=url+"/npm/prismjs@1.15.0";break}}else{switch(lib){case"emojify":lib_url=url+"/emojify.js/1.1.0/images/basic";break;case"katex_config":lib_url=url+"/KaTeX/0.10.0-beta";break;case"mermaid_config":lib_url=url+"/mermaid/8.0.0-rc.8";break;case"prism_config":lib_url=url+"/prism/1.15.0";break}}return lib_url}function getWidth(){if(this.innerWidth){return this.innerWidth}if(document.documentElement&&document.documentElement.clientWidth){return document.documentElement.clientWidth}if(document.body){return document.body.clientWidth}}})(jQuery,document,window,window.Editormd);